# SIRTAH
## Singing Reinforcement Training Applying Haptics
The code presented in this repository is for use in a project where a singer's fundamental frequency is tracked using a version of the YIN algorithm and provided vibrotactile feedback.
<br>
Check out even more details at the [SIRTAH Notion](https://www.notion.so/sirtah/SIRTAH-Singing-Reinforcement-Training-Applying-Haptics-030f82c1d27b420388b12294fd48c314) page.

## About The Code
* 'code.py' is the necessary file name and primary file that the microcontroller needs to run the program. It calls on 'pitch', which is the YIN algorithm that has been incorporated into a modified version of the [Pimoroni Pico Lipo 16MB CircuitPython .uf2](https://circuitpython.org/board/pimoroni_picolipo_16mb/) file; where YIN (written in C; as a module) is wrapped in with the CircuitPython build and boot loaded onto the microcontroller. 

* 'audioprocessing.py' manages the moving average, microphone levels, and removal of DC bias to make the signal cleaner. 

* 'noteprocessing.py' contains the array of note frequencies, the intervals between notes, a logarithmic interpolation scaler for the PWM signal and functions that acquire index, target frequency and difference in frequency value information.

## Equipment
### Microphone
A pulse-density modulation ([PDM](https://www.adafruit.com/product/3492)) microelectromechanical system (MEMS) microphone is used to pick up the signal generated by the singer's voice. It provides a digital signal that is not I2S, but instead, a series of square waves that are synced to a clock, which generates a data line consisting of either 0 or 1. You can find more information on PDM [here](https://learn.adafruit.com/adafruit-pdm-microphone-breakout/).

### Microcontroller
The [Pimoroni Pico Lipo 16MB](https://shop.pimoroni.com/products/pimoroni-pico-lipo?variant=39335427080275) is a microcontroller that is an alternative version of the Raspberry Pi Pico. It uses the same RP2040 chip and pinouts, but the Pimoroni Pico Lipo includes a power button, USB-C port and lithium polymer battery powered and charging capabilities, making it even more ideal to operate as a standalone device. The Pimoroni Pico Lipo runs the YIN algorithm, taking in the data from the PDM MEMS microphone and outputing a pulse width modulated (PWM) signal.

### Haptic Motor
A [coin vibration motor](https://www.adafruit.com/product/1201) receives the PWM signal and generates a vibration dependent on the distance value from the sung frequency to the frequency of a note in western music notation. The further the singer is from any note, the more intense the vibration. If the singer is singing on pitch (withing a small range allowance) the vibration should cease or be nearly unnoticeable.

## Additional Information

### AUTHORS
[Mike Hedges](https://github.com/M1K3Hedges/)
<br>
[Sophus Olsen](https://github.com/sbo-mm/)

### ACKNOWLEDGEMENTS
YIN algorithm ([Alain de Cheveign√© & Hideki Kawahara](https://asa.scitation.org/doi/abs/10.1121/1.1458024)) extracted from [Ashok Fernandez](https://github.com/ashokfernandez/), who extracted from [JorenSix](https://github.com/JorenSix/).
